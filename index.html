<script>
const html5QrCode = new Html5Qrcode("reader");
let scanning = false;

function startScan() {
  scanning = true;
  html5QrCode.start(
    { facingMode: "environment" },
    { fps: 10, qrbox: 250 },
    (decodedText) => {
      if (!scanning) return;

      scanning = false;
      html5QrCode.stop();
      document.getElementById("result").innerText = "掃描結果: " + decodedText;

      // 額外行為（可選）: 如果是網址自動打開
      if (decodedText.startsWith("http")) {
        setTimeout(() => {
          window.open(decodedText, "_blank");
        }, 500);
      }
    }
  )
  .catch(err => {
    document.getElementById("result").innerText = "❌ 錯誤：" + err;
  });
}

startScan();
</script>
